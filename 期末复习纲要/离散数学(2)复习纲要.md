# 离散数学(2) 复习纲要

> ---NonoTion

# Part Ⅰ 图





# Part Ⅱ 计数



### 计数的基础

**基本的计数原则**

1. **乘积法则：**假定一个过程可以分称两个任务，完成第一个任务有$n_1$种方法，完成第二个任务有$n_2$种方法，则完成这个过程有$n_1n_2$种方法
2. **加法法则：**如果完成第一项任务有$n_1$种方法，完成第二项任务有$n_2$种方法，并且两种任务不能同时执行，那么完成第一项任务或第二项任务有$n_1+n_2$种方法

**减法法则（两个集合的容斥原理）**

如果一个任务可以通过$n_1$种方式完成，或者可以通过$n_2$种另一类方法完成，那么这就任务的完成方法数就是$n_1+n_2-n_1\cap n_2$

**除法法则**

如果一个任务能由一个可以用n种方式完成的过程实现，而对于每种完成任务的方式w,在n种方式种恰好有d种与之对应，那么完成这个任务的方法数就是$\frac{n}{d}$

举例:

4个人坐到圆桌旁边，有多少种坐法？一个人左右的相邻的人相同，视为一种坐法

解：

给座位编号1，2，3，4

对于1号座位，有四种选法

对于2号座位，有三种选法

以此类推，共有24种坐法

但每一个座位1可选的4种坐法中都会产生相同的安排

24/4=6 种坐法

**树图**

可以使用树图来解决计数问题

### 鸽巢原理

**定理1 鸽巢原理**

如果k+1个甚至更多的物体放入k个盒子，那么至少有一个盒子包括2个或更多物体

**推论 1**

一个从有k+1甚至更多的元素的集合到k个元素集合的函数f不是一对一函数

**定理2 广义鸽巢原理**

如果将N个物体放入k个盒子，那么至少有一个盒子包含了至少$\lceil \frac{N}{k}\rceil$个物体

 **定理3**

每个由$n^2+1$个不同实数构造的序列都包含一个长为n+1的严格递增子序列或严格递减序列

证明：

​	令$a_1,a_2,...,a_{n^2+1}$为$n^2+1$个不同实数的序列。与序列中的每一项$a_k$相关联着一个有序对，即$(i_k,d_k)$,其中$i_k$是从$a_k$开始的最长的递增子序列的长度，$d_k$是从$a_k$开始的最长的递减子序列的长度

​	假定没有长为n+1的递增或递减子序列。那么$i_k和d_k都是小于或等于n的正整数$,k=1,2,...,$n^2+1$。因此，由乘法法则，关于$(i_k,d_k)$,存在$n^2$个可能的有序对。根据鸽巢原理，$n^2+1$个有序对中必有两个相等。 

存在项$a_s和a_t,s<t$，使得$i_s=i_t，d_s=d_t$，因为序列的项不同,所以有$a_s>a_t或a_s<a_t$，若$a_s>a_t$，则$d_s一定大于d_t$，若$a_s<a_t$，则$i_s一定大于i_t$

### 排列和组合

**排列**

**定理1**

具有n个不同元素的集合的r排列数是
$$
P(n,r)=n(n-1)(n-1)...(n-r+1)
$$
**推论1**

如果n和r都是整数，且$0\le r\le n$,则
$$
P(n,r)=\frac{n!}{(n-r)!}
$$
**组合**

**定理2**

设n是正整数，r是满足$0\le r\le n$的整数，n元素的集合的r组合数等于
$$
C(n,r)=\frac{n!}{r!(n-r)!}
$$
**推论2**

设n和r是满足$r\le n$的负整数，那么C(n,r)=C(n,n-r)

### 二项式系数和恒等式

**二项式定理**

**定理1 二项式定理** 设x和y是变量，n是非负整数，那么
$$
(x+y)^n=\sum_{j=0}^nC(n,j)x^{n-j}y^j
$$
**推论1** 设n是非负整数，那么
$$
\sum_{k=0}^nC(n,k)=2^n
$$
取二项式定理中的x=y=1即可得到



**推论2** 设n是正整数，那么
$$
\sum_{k=0}^n(-1)^kC(n,k)=0
$$


**推论3** 设n是非负整数，那么
$$
\sum_{k=0}^{n}2^kC(n,k)=3^k
$$
**帕斯卡恒等式和三角形**

**定理2 帕斯卡恒等式** 设n和k是满足$n\ge k$的正整数，那么有
$$
C(n+1,k)=C(n,k-1)+C(n,k)
$$
![](C:\Users\Qi Yang\Desktop\复习整理图片\帕斯卡三角形.png)

**其他的二项式系数恒等式**

**定理3 范德蒙德恒等式**

设m,n和r是非负整数，其中r不超过m或n，那么
$$
C(m+n,r)=\sum_{k=0}^rC(m,r-k)C(n,k)
$$
**推论4** 如果n是一个非负整数，那么
$$
C(2n,n)=\sum_{k=0}^nC(n,k)C(n,n-k)=\sum_{k=0}^n[C(n,k)]^2
$$
**定理4** 设n和r都是非负整数，$r\le n$，那么
$$
C(n+1,r+1)=\sum_{j=r}^nC(j,r)
$$
组合证明：

n+1位的比特串中含有r+1个1，如何排列

确定最后一个1的位置为r+1,r+2....n+1

取其余1的方法有C(r,r),C(r+1,r)...C(n,r)种，加法公式可得结果

### 排列和组合的推广

**有重复的排列**

当元素允许重复时，使用乘积法则可以很容易地计数排列数

**定理1** 具有n个对象的集合允许重复的r排列数是 $n^r$

**有重复的组合**

**定理2** n个元素的集合种，允许重复的r组合有C(n+r-1,r)=C(n+r-1,n-1)个

理解为n-1根竖线划分r个元素，共n+r-1个位置

**具有不可区别物体的集合的排列**

**定理3** 设类型1的相同的物体有$n_1$ 个，类型2的相同的物体有$n_2$个，...,类型k的相同的物体有$n_k$个，那么n个不同物体的排列数是
$$
\frac{n!}{n_1!n_2!...n_k!}
$$
证明：乘法原理

C(n,$n_1$)C(n-$n_1,n_2$)...C(n-$n_{k-1},n_k$)
$$
\frac{n!}{n_1!(n-n_1)!}\frac{(n-n_1)!}{n_2!(n-n_1-n_2)!}...\frac{(n-n_1-...-n_{k-1})!}{n_{k}!(n-n_1-n_2-...-n_k)!}
$$
化简可得上式

**把物体放入盒子**

**可辩别的物体和可辩别的盒子**

**定理 4** 

把n个不同的物体分配到k个不同的盒子使得$n_i$个物体放入盒子i(i=1,2,...,k)的方式数等于
$$
\frac{n!}{n_1!n_2!...n_k!}
$$
**不可辨别的物体和可辩别的盒子**

把n个可辩别的物体放入k个可辨别的盒子里的方式数为
$$
C(n+k-1,n-1)=(c+k-1,k)
$$
**可辩别的物体和不可辩别的盒子**

将n个可辩别物体放入k个不可辩别的盒子

没有一个简化的公式来计算这种问题，具体问题具体分析

例如把4个雇员放入三个不可辨别的办公室中

我们用数对表示三个办公室放入的员工数目

(4) (3,1) (2,2) (2,1,1) 

=1+4+6/2(除法原则)+6=14种

**不可辨别的物体和不可辩别的盒子**

将n个不可辩别的物体放入k个不可辩别的盒子

把一本书的六个相同的副本放入4个相同的盒子，有几种放法

放入1个盒子——1

放入2个盒子——3

放入3个盒子——3

放入4个盒子——2

共9种

这个问题等价于将n写成最多k个非递增正整数的和

比如上面的问题 n=6,k=4

6

5,1

4,2

4,1,1

3,3

3,2,1

3,1,1,1

2,2,2

2,2,1,1

#  Part Ⅲ 高级计数

##  递推关系

1. **递推关系的概念**

一个序列的递归定义指定了一个或多个出事的项以及一个由前项确定后项的规则。这个从某些前项求后项的规则就叫做递推关系

2. 用递推关系构造模型

例：

对于不含2个连续0的n位比特串的个数，找出递推关系和初始条件。有多少个这样的5位比特串
$$
n=1，a_n=1
$$

$$
n=2,a_n=3
$$

$$
...
$$

$$
n=n,a_n=a_{n-1}+a_{n-2}
$$

会找出递归关系和初始条件即可

###  求解线性递推关系

####  线性递推关系

**定义：**一个常系数的k阶线性齐次递推关系是形如
$$
a_n=c_{1}a_{n-1}+...+c_{k}a_{n-k}
$$
的递推关系，其中$c_1,c_2,...,c_k$是实数，$c_k\ne0$

阶数：初始条件数

#### 求解常系数线性齐次递推关系

常系数的k阶线性齐次递推关系有形如$a_n=r^n$的解，其中r是常数。

$a_n=r^n$是递推关系$a_n=c_{1}a_{n-1}+...+c_{k}a_{n-k}$的解当且仅当方程
$$
r^n=c_1r^{n-1}+...c_kr^{n-k}
$$

$$
r^{k}-c_1r^{k-1}-...-c_k=0
$$

以r为解

第二个方程叫做递推关系的**特征方程**，它的解叫做递推关系的**特征根**

**定理 1**

设$c_1,c_2$是实数。假设$r^2-c_1r-c_2=0$有两个不同根$r_1,r_2$，那么序列$a_n=c_1a_{n-1}+c_2a_{n-2}$的解是$a_n=\alpha_1r_1^n+\alpha_2r_2^n$

**定理2**

设$c_1,c_2$是实数。假设$r^2-c_1r-c_2=0$有两个相同的根$r_0$，那么序列$a_n=c_1a_{n-1}+c_2a_{n-2}$的解是$a_n=\alpha_1r_0^n+\alpha_2nr_0^n$

**定理3**

设$c_1,c_2,...c_k$是实数。假设$r^k-c_1r^{k-1}-...-c_k=0$有k个不同根$r_1,r_2,..,r_k$，那么序列$a_n=c_1a_{n-1}+c_2a_{n-2}+...+c_ka_{n-k}$的解是$a_n=\alpha_1r_1^n+\alpha_2r_2^n+\alpha_3r_3^n+...+\alpha_kr_k^n$

**定理4**

设$c_1,c_2,...c_k$是实数。假设$r^k-c_1r^{k-1}-...-c_k=0$有t个相同根$r_1,...,r_t$，重数分别为$m_1,...m_t$那么序列$a_n=c_1a_{n-1}+c_2a_{n-2}+...+c_ka_{n-k}$的解是$a_n=(\alpha_{1,0}+\alpha_{1,1}n+...+\alpha_{1,m_1-1}n^{m_1-1})r_1^n+...+(\alpha_{t,0}+\alpha_{t,1}n+...+\alpha_{t,m_t-1}n^{m_t-1})r_t^n$

#### 常系数线性非齐次的递推关系

形如
$$
a_n=c_1a_{n-1}+...+c_ka_{n-k}+F(n)
$$
**定理5**

如果{$a_n^{(p)}$}是常系数非齐次线性递推关系
$$
a_n=c_1a_{n-1}+...+c_ka_{n-k}+F(n)
$$
的一个特解，那么每个解都是{$a_n^{(p)}+a_n^{(h)}$}，其中$a_n^{(h)}$是相伴的齐次递推关系$a_n=c_1a_{n-1}+...+c_ka_{n-k}$的一个解

**定理6**

假设${a_n}$满足线性非齐次递推关系
$$
a_n=c_1a_{n-1}+...+c_ka_{n-k}+F(n)
$$
其中$c_i$是实数，且
$$
F(n)=(b_tn^t+...+b_1n+b_0)s^n
$$
当s不是相伴的线性齐次递推关系的特征方程的根时，存在一个下述形式的特解
$$
(p_tn^t+...+p_1n+p_0)s^n
$$
当s是特征方程的根且它的重数是m时，存在一个下述形式的特解
$$
n^m(p_tn^t+...+p_1n+p_0)s^n
$$

## 分治算法和递推关系

**定理1**

设$f$是满足递推关系
$$
f(n)=af(\frac{n}b)+c
$$
的增函数，其中n被b整除，$a\ge1$，b是大于1的整数，c是一个正实数，那么
$$
f(n)是\begin {cases}
O(n^{n^{log_b^a}}) &\text a>1\\
O(logn) &\text a=1
\end {cases}
$$
而且，当$m=b^k$(其实k是正整数)，$a\ne1$时
$$
f(n)=C_1n^{log_b^a}+C_2
$$
其中$C_1=f(1)+\frac{c}{(a-1)}且C_2=-\frac{c}{a-1}$

**定理2 主定理**

设$f$是满足递推关系
$$
f(n)=af(\frac{n}{b})+cn^d
$$
的增函数，其中n=$b^k$，k是一个正整数，$a\ge1$，b是大于1的整数，c和d是实数，满足c是正的且b是非负的。那么
$$
f(n)是\begin{cases}
O(n^d) &\text a<b^d \\
O(n^dlogn) &\text a=b^d\\
O(n^{log_a^b}) &\text a>b^d
\end{cases}
$$
